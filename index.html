<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoLab - Étudiante en Cybersécurité</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1a1a2e;
            --secondary: #16213e;
            --accent: #4cc9f0;
            --success: #2a9d8f;
            --danger: #e76f51;
            --warning: #e9c46a;
            --light: #e6e6e6;
            --dark: #0f3460;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(rgba(26, 26, 46, 0.7), rgba(22, 33, 62, 0.9)),
                        url('cyber3.jpg');
            background-size: cover;
            background-attachment: fixed;
            background-position: center center;
            background-repeat: no-repeat;
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 40px;
            background: rgba(15, 52, 96, 0.85);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(76, 201, 240, 0.2);
            backdrop-filter: blur(10px);
        }

        h1 {
            color: var(--accent);
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .student-badge {
            display: inline-block;
            background: linear-gradient(45deg, var(--accent), var(--success));
            color: var(--light);
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 1.1rem;
            margin: 10px 0;
            font-weight: 600;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .tagline {
            color: #a9a9a9;
            font-size: 1.2rem;
            max-width: 800px;
            margin: 20px auto 0;
            line-height: 1.6;
        }

        .algorithm-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .algo-btn {
            padding: 15px 25px;
            background: rgba(15, 52, 96, 0.8);
            border: 2px solid rgba(76, 201, 240, 0.3);
            border-radius: 10px;
            color: var(--light);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.1rem;
        }

        .algo-btn:hover {
            background: rgba(76, 201, 240, 0.2);
            transform: translateY(-3px);
            border-color: var(--accent);
        }

        .algo-btn.active {
            background: var(--accent);
            color: var(--primary);
            border-color: var(--accent);
            box-shadow: 0 5px 15px rgba(76, 201, 240, 0.3);
        }

        .algo-btn i {
            font-size: 1.3rem;
        }

        .algorithm-container {
            background: rgba(15, 52, 96, 0.85);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(76, 201, 240, 0.2);
            backdrop-filter: blur(10px);
            min-height: 600px;
            display: none;
        }

        .algorithm-container.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .algorithm-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--accent);
        }

        /* CORRECTION DES CERCLES D'ICÔNES */
        .algorithm-icon {
            width: 70px;
            height: 70px;
            background: linear-gradient(45deg, var(--accent), var(--success));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            flex-shrink: 0; /* Empêche le cercle de se déformer */
        }

        .algorithm-title {
            font-size: 2.2rem;
            color: var(--light);
        }

        .algorithm-description {
            color: #bdc3c7;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }

        @media (max-width: 900px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .control-panel {
            background: rgba(26, 37, 47, 0.6);
            border-radius: 10px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #a9a9a9;
            font-weight: 600;
            font-size: 1.1rem;
        }

        input, textarea, select {
            width: 100%;
            padding: 14px;
            background: rgba(15, 52, 96, 0.5);
            border: 1px solid rgba(76, 201, 240, 0.3);
            border-radius: 8px;
            color: var(--light);
            font-size: 1rem;
            transition: all 0.3s;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 10px rgba(76, 201, 240, 0.2);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        .matrix-input {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 10px;
        }

        .matrix-input input {
            text-align: center;
            font-weight: bold;
            font-size: 1.2rem;
            background: rgba(26, 26, 46, 0.7);
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
            flex: 1;
            justify-content: center;
            min-width: 160px;
        }

        .btn-encrypt {
            background: linear-gradient(45deg, var(--success), #21867a);
            color: white;
        }

        .btn-encrypt:hover {
            background: linear-gradient(45deg, #21867a, var(--success));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(42, 157, 143, 0.4);
        }

        .btn-decrypt {
            background: linear-gradient(45deg, var(--warning), #d68910);
            color: white;
        }

        .btn-decrypt:hover {
            background: linear-gradient(45deg, #d68910, var(--warning));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(233, 196, 106, 0.4);
        }

        .btn-clear {
            background: linear-gradient(45deg, #7f8c8d, #6c7a7d);
            color: white;
        }

        .btn-clear:hover {
            background: linear-gradient(45deg, #6c7a7d, #7f8c8d);
            transform: translateY(-2px);
        }

        .btn-find-key {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            color: white;
        }

        .btn-find-key:hover {
            background: linear-gradient(45deg, #8e44ad, #9b59b6);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(155, 89, 182, 0.4);
        }

        .result-panel {
            background: rgba(26, 37, 47, 0.6);
            border-radius: 10px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .result-title {
            color: var(--accent);
            margin-bottom: 15px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(76, 201, 240, 0.3);
        }

        .result-content {
            word-wrap: break-word;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            line-height: 1.6;
            padding: 20px;
            background: rgba(15, 52, 96, 0.3);
            border-radius: 8px;
            min-height: 200px;
            border: 1px solid rgba(76, 201, 240, 0.1);
        }

        .info-box {
            background: rgba(76, 201, 240, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
            border-left: 4px solid var(--accent);
        }

        .info-title {
            color: var(--accent);
            margin-bottom: 10px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-content {
            color: #bdc3c7;
            line-height: 1.6;
            font-size: 1rem;
        }

        .formula-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 3px solid var(--warning);
            font-family: 'Courier New', monospace;
            color: var(--warning);
        }

        .key-display {
            background: rgba(15, 52, 96, 0.5);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-family: monospace;
            color: var(--success);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .cyber-footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #95a5a6;
            font-size: 0.9rem;
        }

        .cyber-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(76, 201, 240, 0.1);
            padding: 10px 20px;
            border-radius: 20px;
            margin-top: 15px;
            border: 1px solid rgba(76, 201, 240, 0.3);
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
            background: var(--success);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .security-tip {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(15, 52, 96, 0.9);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--accent);
            max-width: 300px;
            font-size: 0.9rem;
            display: none;
        }

        .key-finder-results {
            margin-top: 20px;
            padding: 15px;
            background: rgba(26, 26, 46, 0.7);
            border-radius: 8px;
            border: 1px solid rgba(155, 89, 182, 0.3);
        }

        .key-finder-title {
            color: #9b59b6;
            margin-bottom: 10px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .possible-key {
            padding: 8px 12px;
            margin: 5px;
            background: rgba(155, 89, 182, 0.2);
            border: 1px solid rgba(155, 89, 182, 0.4);
            border-radius: 5px;
            display: inline-block;
            cursor: pointer;
            transition: all 0.2s;
        }

        .possible-key:hover {
            background: rgba(155, 89, 182, 0.4);
            transform: scale(1.05);
        }

        .frequency-table {
            margin-top: 15px;
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .frequency-table th {
            background: rgba(76, 201, 240, 0.2);
            padding: 8px;
            border: 1px solid rgba(76, 201, 240, 0.3);
            text-align: center;
        }

        .frequency-table td {
            padding: 6px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }

        .frequency-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.05);
        }

        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(76, 201, 240, 0.3);
        }

        .tab-btn {
            padding: 10px 20px;
            background: rgba(15, 52, 96, 0.5);
            border: none;
            border-radius: 5px 5px 0 0;
            color: #bdc3c7;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            background: rgba(76, 201, 240, 0.2);
        }

        .tab-btn.active {
            background: rgba(76, 201, 240, 0.3);
            color: white;
            border-bottom: 2px solid var(--accent);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* CORRECTIONS POUR LES ÉCRANS MOBILES */
        @media (max-width: 768px) {
            .algorithm-selector {
                flex-direction: column;
            }
            
            .algo-btn {
                width: 100%;
                justify-content: center;
                padding: 12px 20px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                min-width: unset;
                padding: 12px 20px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .frequency-table {
                font-size: 0.8rem;
            }
            
            .tab-buttons {
                flex-direction: column;
            }
            
            .tab-btn {
                border-radius: 5px;
                margin-bottom: 5px;
            }
            
            /* RÉDUCTION DE LA TAILLE DES ICÔNES SUR MOBILE */
            .algorithm-icon {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }
            
            .algorithm-header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .algorithm-title {
                font-size: 1.8rem;
                text-align: center;
                width: 100%;
            }
            
            .algorithm-description {
                text-align: center;
                font-size: 1rem;
            }
            
            .result-title {
                font-size: 1.3rem;
            }
            
            .info-title {
                font-size: 1.1rem;
            }
            
            .btn i, .algo-btn i, .result-title i, .info-title i {
                font-size: 1.1rem;
            }
            
            .container {
                padding: 10px;
            }
            
            .algorithm-container {
                padding: 20px 15px;
            }
            
            .control-panel, .result-panel {
                padding: 20px 15px;
            }
            
            .matrix-input {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .security-tip {
                position: relative;
                bottom: unset;
                right: unset;
                max-width: 100%;
                margin-top: 20px;
                margin-bottom: 20px;
            }
            
            .cyber-badge {
                flex-direction: column;
                text-align: center;
                padding: 15px;
            }
            
            .cyber-badge span {
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            .algorithm-icon {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
            
            .algorithm-title {
                font-size: 1.5rem;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .student-badge {
                font-size: 1rem;
                padding: 6px 15px;
            }
            
            .tagline {
                font-size: 1rem;
            }
            
            .formula-box {
                font-size: 0.9rem;
                padding: 15px;
            }
            
            .key-display {
                font-size: 0.9rem;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-shield-alt"></i> CryptoLab</h1>
            <div class="student-badge">
                <i class="fas fa-user-graduate"></i> Étudiante en Cybersécurité
            </div>
            <p class="tagline">
                Laboratoire de cryptographie avancée - Implémentation complète des algorithmes classiques 
                pour la sécurité des données et la protection de l'information.
            </p>
        </header>

        <div class="algorithm-selector">
            <button class="algo-btn active" data-algo="cesar">
                <i class="fas fa-exchange-alt"></i> César
            </button>
            <button class="algo-btn" data-algo="vigenere">
                <i class="fas fa-key"></i> Vigenère
            </button>
            <button class="algo-btn" data-algo="hill">
                <i class="fas fa-th"></i> Hill
            </button>
            <button class="algo-btn" data-algo="rsa">
                <i class="fas fa-user-lock"></i> RSA
            </button>
            <button class="algo-btn" data-algo="feistel">
                <i class="fas fa-sync-alt"></i> Feistel
            </button>
        </div>

        <!-- César -->
        <div id="cesar-container" class="algorithm-container active">
            <div class="algorithm-header">
                <div class="algorithm-icon">
                    <i class="fas fa-exchange-alt"></i>
                </div>
                <div>
                    <h2 class="algorithm-title">Chiffrement de César</h2>
                    <p class="algorithm-description">
                        Algorithme de substitution monoalphabétique où chaque lettre du texte est remplacée 
                        par une lettre à distance fixe dans l'alphabet.
                    </p>
                </div>
            </div>

            <div class="content-wrapper">
                <div class="control-panel">
                    <div class="form-group">
                        <label for="cesar-text"><i class="fas fa-font"></i> Texte à traiter :</label>
                        <textarea id="cesar-text" placeholder="Entrez votre message ici...">BONJOUR LE MONDE</textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="cesar-shift"><i class="fas fa-arrows-alt-h"></i> Décalage (clé) :</label>
                        <input type="number" id="cesar-shift" value="3" min="1" max="25">
                    </div>

                    <div class="button-group">
                        <button class="btn btn-encrypt" onclick="chiffrerCesar()">
                            <i class="fas fa-lock"></i> Chiffrer
                        </button>
                        <button class="btn btn-decrypt" onclick="dechiffrerCesar()">
                            <i class="fas fa-unlock"></i> Déchiffrer
                        </button>
                        <button class="btn btn-clear" onclick="effacerCesar()">
                            <i class="fas fa-broom"></i> Effacer
                        </button>
                    </div>
                </div>

                <div class="result-panel">
                    <div class="result-title">
                        <i class="fas fa-poll"></i> Résultats
                    </div>
                    <div id="cesar-result" class="result-content">
                        <span class="status-indicator"></span> Prêt à chiffrer...
                    </div>

                    <div class="info-box">
                        <div class="info-title">
                            <i class="fas fa-info-circle"></i> Comment ça marche ?
                        </div>
                        <div class="info-content">
                            <p>Le chiffrement de César déplace chaque lettre d'un nombre fixe de positions dans l'alphabet.</p>
                            <div class="formula-box">
                                <strong>Formule de chiffrement :</strong><br>
                                C = (P + K) mod 26<br><br>
                                <strong>Formule de déchiffrement :</strong><br>
                                P = (C - K) mod 26<br><br>
                                Où:<br>
                                C = Lettre chiffrée<br>
                                P = Lettre originale<br>
                                K = Décalage (clé)<br>
                                mod 26 = modulo 26 (pour rester dans l'alphabet)
                            </div>
                            <p><strong>Exemple :</strong> Avec K=3, A→D, B→E, C→F, etc.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vigenère -->
        <div id="vigenere-container" class="algorithm-container">
            <div class="algorithm-header">
                <div class="algorithm-icon">
                    <i class="fas fa-key"></i>
                </div>
                <div>
                    <h2 class="algorithm-title">Chiffrement de Vigenère</h2>
                    <p class="algorithm-description">
                        Chiffrement polyalphabétique qui utilise une série de différents chiffrements de César 
                        basés sur les lettres d'une clé.
                    </p>
                </div>
            </div>

            <div class="content-wrapper">
                <div class="control-panel">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="chiffrement">Chiffrement/Déchiffrement</button>
                        <button class="tab-btn" data-tab="trouver-cle">Trouver la clé</button>
                    </div>
                    
                    <!-- Onglet Chiffrement/Déchiffrement -->
                    <div id="chiffrement-tab" class="tab-content active">
                        <div class="form-group">
                            <label for="vigenere-text"><i class="fas fa-font"></i> Texte à traiter :</label>
                            <textarea id="vigenere-text" placeholder="Entrez votre message ici...">ATTACKATDAWN</textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="vigenere-key"><i class="fas fa-key"></i> Clé secrète :</label>
                            <input type="text" id="vigenere-key" value="LEMON" placeholder="Entrez votre clé...">
                        </div>

                        <div class="button-group">
                            <button class="btn btn-encrypt" onclick="chiffrerVigenere()">
                                <i class="fas fa-lock"></i> Chiffrer
                            </button>
                            <button class="btn btn-decrypt" onclick="dechiffrerVigenere()">
                                <i class="fas fa-unlock"></i> Déchiffrer
                            </button>
                            <button class="btn btn-clear" onclick="effacerVigenere()">
                                <i class="fas fa-broom"></i> Effacer
                            </button>
                        </div>
                    </div>
                    
                    <!-- Onglet Trouver la clé -->
                    <div id="trouver-cle-tab" class="tab-content">
                        <div class="form-group">
                            <label for="vigenere-message-clair"><i class="fas fa-font"></i> Message clair (texte original) :</label>
                            <textarea id="vigenere-message-clair" placeholder="Entrez le message clair ici...">ATTACKATDAWN</textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="vigenere-message-chiffre"><i class="fas fa-lock"></i> Message chiffré :</label>
                            <textarea id="vigenere-message-chiffre" placeholder="Entrez le message chiffré ici...">LXFOPVEFRNHR</textarea>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-find-key" onclick="trouverCleVigenere()">
                                <i class="fas fa-search"></i> Trouver la clé
                            </button>
                            <button class="btn btn-clear" onclick="effacerRechercheCle()">
                                <i class="fas fa-broom"></i> Effacer
                            </button>
                        </div>
                    </div>
                </div>

                <div class="result-panel">
                    <div class="result-title">
                        <i class="fas fa-poll"></i> Résultats
                    </div>
                    <div id="vigenere-result" class="result-content">
                        <span class="status-indicator"></span> Prêt à chiffrer...
                    </div>

                    <div id="vigenere-key-finder" class="key-finder-results" style="display: none;">
                        <!-- Les résultats du trouveur de clé apparaîtront ici -->
                    </div>

                    <div class="info-box">
                        <div class="info-title">
                            <i class="fas fa-info-circle"></i> Comment ça marche ?
                        </div>
                        <div class="info-content">
                            <p>Le chiffrement de Vigenère utilise une clé répétée pour créer plusieurs alphabets de César.</p>
                            <div class="formula-box">
                                <strong>Formule de chiffrement :</strong><br>
                                C_i = (P_i + K_i) mod 26<br><br>
                                <strong>Formule de déchiffrement :</strong><br>
                                P_i = (C_i - K_i) mod 26<br><br>
                                <strong>Formule pour trouver la clé :</strong><br>
                                K_i = (C_i - P_i + 26) mod 26<br><br>
                                Où:<br>
                                C_i = i-ème lettre chiffrée<br>
                                P_i = i-ème lettre originale<br>
                                K_i = i-ème lettre de la clé (répétée)<br>
                                i = position dans le texte
                            </div>
                            <p><strong>Exemple :</strong> Clé "LEMON", Message "ATTACKATDAWN" → Chiffré "LXFOPVEFRNHR"</p>
                            <p><strong>Pour trouver la clé :</strong> Entrez le message clair et le message chiffré, puis cliquez sur "Trouver la clé".</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Hill -->
        <div id="hill-container" class="algorithm-container">
            <div class="algorithm-header">
                <div class="algorithm-icon">
                    <i class="fas fa-th"></i>
                </div>
                <div>
                    <h2 class="algorithm-title">Chiffrement de Hill</h2>
                    <p class="algorithm-description">
                        Chiffrement par blocs basé sur l'algèbre linéaire. Utilise une matrice carrée 
                        comme clé pour chiffrer des paires ou triplets de lettres.
                    </p>
                </div>
            </div>

            <div class="content-wrapper">
                <div class="control-panel">
                    <div class="form-group">
                        <label for="hill-text"><i class="fas fa-font"></i> Texte à traiter (majuscules) :</label>
                        <textarea id="hill-text" placeholder="Entrez votre message ici (longueur paire)...">HELP</textarea>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-th"></i> Matrice 2x2 (clé) :</label>
                        <div class="matrix-input">
                            <input type="number" id="hill-a" value="3" placeholder="a">
                            <input type="number" id="hill-b" value="3" placeholder="b">
                            <input type="number" id="hill-c" value="2" placeholder="c">
                            <input type="number" id="hill-d" value="5" placeholder="d">
                        </div>
                    </div>

                    <div class="button-group">
                        <button class="btn btn-encrypt" onclick="chiffrerHill()">
                            <i class="fas fa-lock"></i> Chiffrer
                        </button>
                        <button class="btn btn-decrypt" onclick="dechiffrerHill()">
                            <i class="fas fa-unlock"></i> Déchiffrer
                        </button>
                        <button class="btn btn-clear" onclick="effacerHill()">
                            <i class="fas fa-broom"></i> Effacer
                        </button>
                    </div>
                </div>

                <div class="result-panel">
                    <div class="result-title">
                        <i class="fas fa-poll"></i> Résultats
                    </div>
                    <div id="hill-result" class="result-content">
                        <span class="status-indicator"></span> Prêt à chiffrer...
                    </div>

                    <div id="hill-matrix-info" class="key-display">
                        Information sur la matrice apparaîtra ici...
                    </div>

                    <div class="info-box">
                        <div class="info-title">
                            <i class="fas fa-info-circle"></i> Méthode Hill (Matrice 2x2)
                        </div>
                        <div class="info-content">
                            <p>Le chiffrement traite les lettres par paires en utilisant une matrice clé.</p>
                            <div class="formula-box">
                                <strong>Formules de chiffrement :</strong><br>
                                C₁ = (a×P₁ + b×P₂) mod 26<br>
                                C₂ = (c×P₁ + d×P₂) mod 26<br><br>
                                <strong>Matrice inverse pour déchiffrement :</strong><br>
                                M⁻¹ = (1/det(M)) × [[d, -b], [-c, a]] mod 26<br><br>
                                <strong>Condition :</strong><br>
                                det(M) doit être premier avec 26<br>
                                pgcd(det(M), 26) = 1
                            </div>
                            <p><strong>Exemple :</strong> Matrice [[3,3],[2,5]], "HE" → "RI"</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RSA -->
        <div id="rsa-container" class="algorithm-container">
            <div class="algorithm-header">
                <div class="algorithm-icon">
                    <i class="fas fa-user-lock"></i>
                </div>
                <div>
                    <h2 class="algorithm-title">Chiffrement RSA</h2>
                    <p class="algorithm-description">
                        Algorithme de cryptographie asymétrique largement utilisé pour la transmission 
                        sécurisée de données. Basé sur la difficulté de factoriser de grands nombres.
                    </p>
                </div>
            </div>

            <div class="content-wrapper">
                <div class="control-panel">
                    <div class="form-group">
                        <label for="rsa-text"><i class="fas fa-font"></i> Message numérique :</label>
                        <input type="number" id="rsa-text" value="65" placeholder="Entrez un nombre à chiffrer...">
                    </div>
                    
                    <div class="form-group">
                        <label for="rsa-p"><i class="fas fa-hashtag"></i> Nombre premier p :</label>
                        <input type="number" id="rsa-p" value="17">
                    </div>
                    
                    <div class="form-group">
                        <label for="rsa-q"><i class="fas fa-hashtag"></i> Nombre premier q :</label>
                        <input type="number" id="rsa-q" value="11">
                    </div>
                    
                    <div class="form-group">
                        <label for="rsa-e"><i class="fas fa-equals"></i> Exposant public e :</label>
                        <input type="number" id="rsa-e" value="7">
                    </div>

                    <div class="button-group">
                        <button class="btn btn-encrypt" onclick="chiffrerRSA()">
                            <i class="fas fa-lock"></i> Chiffrer
                        </button>
                        <button class="btn btn-decrypt" onclick="dechiffrerRSA()">
                            <i class="fas fa-unlock"></i> Déchiffrer
                        </button>
                        <button class="btn btn-clear" onclick="effacerRSA()">
                            <i class="fas fa-broom"></i> Effacer
                        </button>
                    </div>
                </div>

                <div class="result-panel">
                    <div class="result-title">
                        <i class="fas fa-poll"></i> Résultats
                    </div>
                    <div id="rsa-result" class="result-content">
                        <span class="status-indicator"></span> Prêt à chiffrer...
                    </div>

                    <div id="rsa-keys" class="key-display">
                        Les clés RSA apparaîtront ici...
                    </div>

                    <div class="info-box">
                        <div class="info-title">
                            <i class="fas fa-info-circle"></i> Algorithme RSA
                        </div>
                        <div class="info-content">
                            <p>RSA utilise une paire de clés : publique (chiffrement) et privée (déchiffrement).</p>
                            <div class="formula-box">
                                <strong>Génération des clés :</strong><br>
                                1. n = p × q<br>
                                2. φ(n) = (p-1)(q-1)<br>
                                3. Choisir e tel que 1 < e < φ(n) et pgcd(e, φ(n)) = 1<br>
                                4. Trouver d tel que d × e ≡ 1 mod φ(n)<br><br>
                                <strong>Chiffrement :</strong><br>
                                C = Mᵉ mod n<br><br>
                                <strong>Déchiffrement :</strong><br>
                                M = Cᵈ mod n
                            </div>
                            <p><strong>Sécurité :</strong> Basée sur la difficulté de factoriser n en p et q.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Feistel MODIFIÉ -->
        <div id="feistel-container" class="algorithm-container">
            <div class="algorithm-header">
                <div class="algorithm-icon">
                    <i class="fas fa-sync-alt"></i>
                </div>
                <div>
                    <h2 class="algorithm-title">Schéma de Feistel (Simplifié)</h2>
                    <p class="algorithm-description">
                        Structure symétrique pour 4 bits. Divise le bloc en deux moitiés de 2 bits 
                        et applique des fonctions F prédéfinies. Pas de clé utilisée dans cette version.
                    </p>
                </div>
            </div>

            <div class="content-wrapper">
                <div class="control-panel">
                    <div class="form-group">
                        <label for="feistel-text"><i class="fas fa-font"></i> Entrée binaire (4 bits) :</label>
                        <input type="text" id="feistel-text" value="1010" placeholder="Entrez 4 bits (ex: 1010)">
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-info-circle"></i> Fonctions prédéfinies :</label>
                        <div class="info-content" style="padding: 10px; background: rgba(15, 52, 96, 0.3); border-radius: 5px;">
                            <strong>F1:</strong> 00→01, 01→10, 10→11, 11→00<br>
                            <strong>F2:</strong> 00→10, 01→11, 10→00, 11→01
                        </div>
                    </div>

                    <div class="button-group">
                        <button class="btn btn-encrypt" onclick="chiffrerFeistel()">
                            <i class="fas fa-lock"></i> Chiffrer
                        </button>
                        <button class="btn btn-decrypt" onclick="dechiffrerFeistel()">
                            <i class="fas fa-unlock"></i> Déchiffrer
                        </button>
                        <button class="btn btn-clear" onclick="effacerFeistel()">
                            <i class="fas fa-broom"></i> Effacer
                        </button>
                    </div>
                </div>

                <div class="result-panel">
                    <div class="result-title">
                        <i class="fas fa-poll"></i> Résultats
                    </div>
                    <div id="feistel-result" class="result-content">
                        <span class="status-indicator"></span> Prêt à chiffrer...
                    </div>

                    <div class="info-box">
                        <div class="info-title">
                            <i class="fas fa-info-circle"></i> Structure de Feistel (4 bits)
                        </div>
                        <div class="info-content">
                            <p>Le schéma divise 4 bits en g (2 bits gauche) et d (2 bits droite).</p>
                            <div class="formula-box">
                                <strong>Formules de chiffrement :</strong><br>
                                Round 1: g₁ = d₀, d₁ = g₀ ⊕ F₁(d₀)<br>
                                Round 2: g₂ = d₁, d₂ = g₁ ⊕ F₂(d₁)<br>
                                Résultat: g₂ || d₂<br><br>
                                <strong>Formules de déchiffrement :</strong><br>
                                Round 2 inverse: g₁ = d₂ ⊕ F₂(g₂), d₁ = g₂<br>
                                Round 1 inverse: g₀ = d₁ ⊕ F₁(g₁), d₀ = g₁
                            </div>
                            <p><strong>Exemple :</strong> Entrée "1010" → Sortie "0101"</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="cyber-footer">
            <p>CryptoLab - Système de Chiffrement Complet &copy; 2025</p>
            <div class="cyber-badge">
                <i class="fas fa-shield-alt"></i>
                <span>Projet d'Étudiante en Cybersécurité - Sécurité des Données et Cryptographie</span>
            </div>
        </footer>

        <div class="security-tip" id="securityTip">
            <strong><i class="fas fa-lightbulb"></i> Conseil Sécurité :</strong>
            <p>Utilisez toujours des clés fortes et changez-les régulièrement pour une sécurité optimale.</p>
        </div>
    </div>

    <script>
        // ==================== NAVIGATION ET ONGLETS ====================
        document.querySelectorAll('.algo-btn').forEach(button => {
            button.addEventListener('click', function() {
                document.querySelectorAll('.algo-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.algorithm-container').forEach(container => container.classList.remove('active'));
                
                this.classList.add('active');
                const algo = this.getAttribute('data-algo');
                document.getElementById(`${algo}-container`).classList.add('active');
                
                showRandomSecurityTip();
            });
        });

        // Gestion des onglets pour Vigenère
        document.querySelectorAll('.tab-btn').forEach(button => {
            button.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                // Gérer les onglets actifs
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                this.classList.add('active');
                document.getElementById(`${tabId}-tab`).classList.add('active');
                
                // Effacer les résultats précédents
                if (tabId === 'chiffrement') {
                    document.getElementById('vigenere-key-finder').style.display = 'none';
                }
            });
        });

        function showRandomSecurityTip() {
            const tips = [
                "Utilisez des clés d'au moins 16 caractères pour une sécurité optimale.",
                "Ne réutilisez jamais la même clé pour différents algorithmes.",
                "Changez vos clés régulièrement pour limiter les risques.",
                "Les clés asymétriques (RSA) sont plus sécurisées mais plus lentes.",
                "Toujours vérifier que votre matrice Hill est inversible modulo 26.",
                "Le chiffrement par blocs est plus sécurisé que le chiffrement par flux.",
                "En production, utilisez AES au lieu de DES pour une meilleure sécurité.",
                "Pour Vigenère, la clé peut être trouvée si on a le texte clair et le texte chiffré.",
                "Utilisez des clés longues et aléatoires pour Vigenère pour résister aux attaques."
            ];
            
            const randomTip = tips[Math.floor(Math.random() * tips.length)];
            document.getElementById('securityTip').innerHTML = 
                `<strong><i class="fas fa-lightbulb"></i> Conseil Sécurité :</strong>
                <p>${randomTip}</p>`;
            
            const tipElement = document.getElementById('securityTip');
            tipElement.style.display = 'block';
            setTimeout(() => tipElement.style.display = 'none', 5000);
        }

        // ==================== CHIFFREMENT DE CÉSAR ====================
        function chiffrerCesar() {
            const text = document.getElementById('cesar-text').value.toUpperCase();
            const shift = parseInt(document.getElementById('cesar-shift').value);
            
            if (isNaN(shift) || shift < 1 || shift > 25) {
                document.getElementById('cesar-result').innerHTML = 
                    '<span style="color: #e76f51;">Erreur : Le décalage doit être entre 1 et 25</span>';
                return;
            }
            
            let result = '';
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                if (char >= 'A' && char <= 'Z') {
                    const code = ((char.charCodeAt(0) - 65 + shift) % 26) + 65;
                    result += String.fromCharCode(code);
                } else {
                    result += char;
                }
            }
            
            document.getElementById('cesar-result').innerHTML = 
                `<strong>Texte original:</strong> ${text}<br><br>` +
                `<strong>Décalage (clé):</strong> ${shift}<br><br>` +
                `<strong>Texte chiffré:</strong> <span style="color: #2a9d8f;">${result}</span>`;
        }

        function dechiffrerCesar() {
            const text = document.getElementById('cesar-text').value.toUpperCase();
            const shift = parseInt(document.getElementById('cesar-shift').value);
            
            if (isNaN(shift) || shift < 1 || shift > 25) {
                document.getElementById('cesar-result').innerHTML = 
                    '<span style="color: #e76f51;">Erreur : Le décalage doit être entre 1 et 25</span>';
                return;
            }
            
            let result = '';
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                if (char >= 'A' && char <= 'Z') {
                    const code = ((char.charCodeAt(0) - 65 - shift + 26) % 26) + 65;
                    result += String.fromCharCode(code);
                } else {
                    result += char;
                }
            }
            
            document.getElementById('cesar-result').innerHTML = 
                `<strong>Texte chiffré:</strong> ${text}<br><br>` +
                `<strong>Décalage (clé):</strong> ${shift}<br><br>` +
                `<strong>Texte déchiffré:</strong> <span style="color: #e9c46a;">${result}</span>`;
        }

        function effacerCesar() {
            document.getElementById('cesar-text').value = '';
            document.getElementById('cesar-result').innerHTML = 
                '<span class="status-indicator"></span> Prêt à chiffrer...';
        }

        // ==================== CHIFFREMENT DE VIGENÈRE ====================
        function chiffrerVigenere() {
            const text = document.getElementById('vigenere-text').value.toUpperCase().replace(/[^A-Z]/g, '');
            const key = document.getElementById('vigenere-key').value.toUpperCase().replace(/[^A-Z]/g, '');
            
            if (key.length === 0) {
                document.getElementById('vigenere-result').innerHTML = 
                    '<span style="color: #e76f51;">Erreur : Veuillez entrer une clé valide !</span>';
                return;
            }
            
            if (text.length === 0) {
                document.getElementById('vigenere-result').innerHTML = 
                    '<span style="color: #e76f51;">Erreur : Veuillez entrer un texte à chiffrer !</span>';
                return;
            }
            
            let result = '';
            for (let i = 0; i < text.length; i++) {
                const textChar = text.charCodeAt(i) - 65;
                const keyChar = key.charCodeAt(i % key.length) - 65;
                const encryptedChar = (textChar + keyChar) % 26;
                result += String.fromCharCode(encryptedChar + 65);
            }
            
            let table = '<strong>Correspondances :</strong><br>';
            for (let i = 0; i < Math.min(text.length, 10); i++) {
                table += `${text[i]} (${text.charCodeAt(i)-65}) + ${key[i % key.length]} (${key.charCodeAt(i % key.length)-65}) = ${result[i]} (${result.charCodeAt(i)-65})<br>`;
            }
            
            document.getElementById('vigenere-result').innerHTML = 
                `<strong>Texte original:</strong> ${text}<br><br>` +
                `<strong>Clé:</strong> ${key} (répétée)<br><br>` +
                `${table}<br>` +
                `<strong>Texte chiffré:</strong> <span style="color: #2a9d8f;">${result}</span>`;
        }

        function dechiffrerVigenere() {
            const text = document.getElementById('vigenere-text').value.toUpperCase().replace(/[^A-Z]/g, '');
            const key = document.getElementById('vigenere-key').value.toUpperCase().replace(/[^A-Z]/g, '');
            
            if (key.length === 0) {
                document.getElementById('vigenere-result').innerHTML = 
                    '<span style="color: #e76f51;">Erreur : Veuillez entrer une clé valide !</span>';
                return;
            }
            
            if (text.length === 0) {
                document.getElementById('vigenere-result').innerHTML = 
                    '<span style="color: #e76f51;">Erreur : Veuillez entrer un texte à déchiffrer !</span>';
                return;
            }
            
            let result = '';
            for (let i = 0; i < text.length; i++) {
                const textChar = text.charCodeAt(i) - 65;
                const keyChar = key.charCodeAt(i % key.length) - 65;
                const decryptedChar = (textChar - keyChar + 26) % 26;
                result += String.fromCharCode(decryptedChar + 65);
            }
            
            document.getElementById('vigenere-result').innerHTML = 
                `<strong>Texte chiffré:</strong> ${text}<br><br>` +
                `<strong>Clé:</strong> ${key} (répétée)<br><br>` +
                `<strong>Texte déchiffré:</strong> <span style="color: #e9c46a;">${result}</span>`;
        }

        function effacerVigenere() {
            document.getElementById('vigenere-text').value = '';
            document.getElementById('vigenere-key').value = 'LEMON';
            document.getElementById('vigenere-result').innerHTML = 
                '<span class="status-indicator"></span> Prêt à chiffrer...';
            document.getElementById('vigenere-key-finder').style.display = 'none';
        }

        // ==================== TROUVER LA CLÉ VIGENÈRE (nouvelle version) ====================
        function trouverCleVigenere() {
            const messageClair = document.getElementById('vigenere-message-clair').value.toUpperCase().replace(/[^A-Z]/g, '');
            const messageChiffre = document.getElementById('vigenere-message-chiffre').value.toUpperCase().replace(/[^A-Z]/g, '');
            
            if (messageClair.length === 0) {
                document.getElementById('vigenere-result').innerHTML = 
                    '<span style="color: #e76f51;">Erreur : Veuillez entrer le message clair !</span>';
                return;
            }
            
            if (messageChiffre.length === 0) {
                document.getElementById('vigenere-result').innerHTML = 
                    '<span style="color: #e76f51;">Erreur : Veuillez entrer le message chiffré !</span>';
                return;
            }
            
            if (messageClair.length !== messageChiffre.length) {
                document.getElementById('vigenere-result').innerHTML = 
                    `<span style="color: #e76f51;">Erreur : Les messages doivent avoir la même longueur !<br>` +
                    `Message clair : ${messageClair.length} caractères<br>` +
                    `Message chiffré : ${messageChiffre.length} caractères</span>`;
                return;
            }
            
            // Calcul direct de la clé
            let cleTrouvee = '';
            let correspondances = '<strong>Calcul des lettres de la clé :</strong><br><br>';
            
            for (let i = 0; i < messageClair.length; i++) {
                const P = messageClair.charCodeAt(i) - 65; // Lettre claire
                const C = messageChiffre.charCodeAt(i) - 65; // Lettre chiffrée
                
                // Calcul de la lettre de la clé : K = (C - P + 26) mod 26
                const K = (C - P + 26) % 26;
                const lettreCle = String.fromCharCode(K + 65);
                cleTrouvee += lettreCle;
                
                correspondances += `Position ${i+1}: ` +
                    `P = ${messageClair[i]} (${P}), ` +
                    `C = ${messageChiffre[i]} (${C}), ` +
                    `K = (${C} - ${P} + 26) mod 26 = ${K} → ${lettreCle}<br>`;
            }
            
            // Trouver la longueur réelle de la clé en cherchant des motifs
            let longueursPossibles = [];
            
            // Tester différentes longueurs de clé (de 1 à 20)
            for (let longueur = 1; longueur <= Math.min(20, cleTrouvee.length); longueur++) {
                let estValide = true;
                
                // Vérifier si la clé se répète correctement
                for (let i = 0; i < cleTrouvee.length; i++) {
                    if (cleTrouvee[i] !== cleTrouvee[i % longueur]) {
                        estValide = false;
                        break;
                    }
                }
                
                if (estValide) {
                    longueursPossibles.push(longueur);
                }
            }
            
            // Déterminer la clé réelle (la plus courte possible)
            let cleReelle = '';
            if (longueursPossibles.length > 0) {
                const longueurMin = Math.min(...longueursPossibles);
                cleReelle = cleTrouvee.substring(0, longueurMin);
            } else {
                // Si on ne trouve pas de motif, on prend toute la clé
                cleReelle = cleTrouvee;
            }
            
            // Vérifier si la clé fonctionne
            let verification = '';
            let cleVerifiee = '';
            
            for (let i = 0; i < messageClair.length; i++) {
                const P = messageClair.charCodeAt(i) - 65;
                const K = cleReelle.charCodeAt(i % cleReelle.length) - 65;
                const C_calcule = (P + K) % 26;
                const lettreCalculee = String.fromCharCode(C_calcule + 65);
                
                if (lettreCalculee === messageChiffre[i]) {
                    cleVerifiee += '✓';
                } else {
                    cleVerifiee += '✗';
                }
            }
            
            // Afficher les résultats
            let resultatsHTML = `<div class="key-finder-title"><i class="fas fa-key"></i> Résultats de la recherche de clé</div>`;
            
            resultatsHTML += `<p><strong>Clé calculée (complète) :</strong> ${cleTrouvee}</p>`;
            
            if (longueursPossibles.length > 0) {
                resultatsHTML += `<p><strong>Longueurs de clé possibles :</strong> ${longueursPossibles.join(', ')}</p>`;
                resultatsHTML += `<p><strong>Clé réelle (motif répété) :</strong> <span style="color: #2a9d8f; font-weight: bold;">${cleReelle}</span></p>`;
            } else {
                resultatsHTML += `<p><strong>Clé probable (pas de motif évident) :</strong> <span style="color: #e9c46a; font-weight: bold;">${cleReelle}</span></p>`;
            }
            
            resultatsHTML += `<p><strong>Vérification :</strong> ${cleVerifiee}</p>`;
            
            // Ajouter un bouton pour appliquer la clé
            resultatsHTML += `<br><button class="btn btn-find-key" onclick="appliquerCleVigenere('${cleReelle}')" style="width: auto; padding: 10px 20px;">
                <i class="fas fa-check"></i> Appliquer cette clé
            </button>`;
            
            // Afficher le détail des calculs
            resultatsHTML += `<br><br><details>
                <summary><strong>Voir le détail des calculs</strong></summary>
                <div style="margin-top: 10px; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 5px;">
                    ${correspondances}
                </div>
            </details>`;
            
            // Afficher un tableau récapitulatif
            resultatsHTML += `<br><br><strong>Tableau récapitulatif :</strong>`;
            resultatsHTML += `<table class="frequency-table">`;
            resultatsHTML += `<tr><th>Position</th><th>Message clair</th><th>Message chiffré</th><th>Clé calculée</th><th>Vérification</th></tr>`;
            
            for (let i = 0; i < Math.min(20, messageClair.length); i++) {
                resultatsHTML += `<tr>`;
                resultatsHTML += `<td>${i+1}</td>`;
                resultatsHTML += `<td>${messageClair[i]}</td>`;
                resultatsHTML += `<td>${messageChiffre[i]}</td>`;
                resultatsHTML += `<td>${cleTrouvee[i]}</td>`;
                resultatsHTML += `<td>${cleVerifiee[i] || ''}</td>`;
                resultatsHTML += `</tr>`;
            }
            
            if (messageClair.length > 20) {
                resultatsHTML += `<tr><td colspan="5" style="text-align: center;">... ${messageClair.length - 20} autres lignes ...</td></tr>`;
            }
            
            resultatsHTML += `</table>`;
            
            // Afficher les résultats
            document.getElementById('vigenere-key-finder').innerHTML = resultatsHTML;
            document.getElementById('vigenere-key-finder').style.display = 'block';
            
            // Mettre à jour le résultat principal
            document.getElementById('vigenere-result').innerHTML = 
                `<strong>Analyse terminée !</strong><br><br>` +
                `<strong>Message clair :</strong> ${messageClair}<br>` +
                `<strong>Message chiffré :</strong> ${messageChiffre}<br><br>` +
                `<strong>Clé trouvée :</strong> <span style="color: #9b59b6; font-weight: bold;">${cleReelle}</span><br>` +
                `<span style="color: #4cc9f0;"><i class="fas fa-search"></i> Voir les détails ci-dessous.</span>`;
        }

        function appliquerCleVigenere(cle) {
            document.getElementById('vigenere-key').value = cle;
            document.getElementById('vigenere-result').innerHTML += 
                `<br><br><strong>Clé appliquée :</strong> <span style="color: #2a9d8f;">${cle}</span>`;
            
            // Basculer vers l'onglet de chiffrement
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector('[data-tab="chiffrement"]').classList.add('active');
            document.getElementById('chiffrement-tab').classList.add('active');
            
            // Mettre le message chiffré dans la zone de texte
            document.getElementById('vigenere-text').value = document.getElementById('vigenere-message-chiffre').value;
            
            // Déchiffrer automatiquement avec la nouvelle clé
            setTimeout(() => dechiffrerVigenere(), 500);
        }

        function effacerRechercheCle() {
            document.getElementById('vigenere-message-clair').value = '';
            document.getElementById('vigenere-message-chiffre').value = '';
            document.getElementById('vigenere-result').innerHTML = 
                '<span class="status-indicator"></span> Prêt à rechercher une clé...';
            document.getElementById('vigenere-key-finder').style.display = 'none';
        }

        // ==================== CHIFFREMENT DE HILL ====================
        function modInverse(a, m) {
            a = ((a % m) + m) % m;
            for (let x = 1; x < m; x++) {
                if ((a * x) % m === 1) return x;
            }
            return -1;
        }

        function determinant(a, b, c, d) {
            return a * d - b * c;
        }

        function inverseMatrix(a, b, c, d, mod) {
            const det = determinant(a, b, c, d);
            const detMod = ((det % mod) + mod) % mod;
            const detInv = modInverse(detMod, mod);
            
            if (detInv === -1) throw new Error("Matrice non inversible modulo " + mod);
            
            const invA = (d * detInv) % mod;
            const invB = (-b * detInv) % mod;
            const invC = (-c * detInv) % mod;
            const invD = (a * detInv) % mod;
            
            return [
                ((invA % mod) + mod) % mod,
                ((invB % mod) + mod) % mod,
                ((invC % mod) + mod) % mod,
                ((invD % mod) + mod) % mod
            ];
        }

        function chiffrerHill() {
            try {
                const text = document.getElementById('hill-text').value.toUpperCase().replace(/[^A-Z]/g, '');
                const a = parseInt(document.getElementById('hill-a').value);
                const b = parseInt(document.getElementById('hill-b').value);
                const c = parseInt(document.getElementById('hill-c').value);
                const d = parseInt(document.getElementById('hill-d').value);
                const mod = 26;
                
                const det = determinant(a, b, c, d);
                const detMod = ((det % mod) + mod) % mod;
                const detInv = modInverse(detMod, mod);
                
                if (detInv === -1) {
                    throw new Error(`Le déterminant (${detMod}) n'a pas d'inverse modulo ${mod}.`);
                }
                
                let paddedText = text;
                if (paddedText.length % 2 !== 0) paddedText += 'X';
                
                let result = '';
                let steps = '<strong>Détail des calculs :</strong><br><br>';
                
                for (let i = 0; i < paddedText.length; i += 2) {
                    const p1 = paddedText.charCodeAt(i) - 64;
                    const p2 = paddedText.charCodeAt(i + 1) - 64;
                    
                    const lettre1 = paddedText[i];
                    const lettre2 = paddedText[i + 1];
                    
                    const c1 = (a * p1 + b * p2) % mod;
                    const c2 = (c * p1 + d * p2) % mod;
                    
                    const c1_final = c1 === 0 ? 26 : c1;
                    const c2_final = c2 === 0 ? 26 : c2;
                    
                    const lettreChiffree1 = String.fromCharCode(c1_final + 64);
                    const lettreChiffree2 = String.fromCharCode(c2_final + 64);
                    
                    result += lettreChiffree1 + lettreChiffree2;
                    
                    steps += `<strong>Paire ${i/2 + 1}: "${lettre1}${lettre2}"</strong><br>`;
                    steps += `${lettre1} → p1 = ${p1}<br>`;
                    steps += `${lettre2} → p2 = ${p2}<br><br>`;
                    
                    steps += `<strong>Calculs :</strong><br>`;
                    steps += `c1 = (${a}×${p1} + ${b}×${p2}) mod 26 = ${a * p1 + b * p2} mod 26 = ${c1}`;
                    if (c1 === 0) steps += ` (converti en 26 pour Z)<br>`;
                    else steps += `<br>`;
                    steps += `Lettre = ${lettreChiffree1}<br><br>`;
                    
                    steps += `c2 = (${c}×${p1} + ${d}×${p2}) mod 26 = ${c * p1 + d * p2} mod 26 = ${c2}`;
                    if (c2 === 0) steps += ` (converti en 26 pour Z)<br>`;
                    else steps += `<br>`;
                    steps += `Lettre = ${lettreChiffree2}<br><br>`;
                    
                    steps += `<strong>Résultat : "${lettreChiffree1}${lettreChiffree2}"</strong><br><br>`;
                    steps += '─'.repeat(50) + '<br><br>';
                }
                
                const invMatrix = inverseMatrix(a, b, c, d, mod);
                
                document.getElementById('hill-result').innerHTML = 
                    `<strong>Texte original:</strong> ${text}<br>` +
                    `<strong>Texte avec padding:</strong> ${paddedText}<br><br>` +
                    `${steps}` +
                    `<strong>Texte chiffré complet:</strong> <span style="color: #2a9d8f; font-size: 1.2rem;">${result}</span>`;
                
                document.getElementById('hill-matrix-info').innerHTML = 
                    `<strong>Matrice de chiffrement:</strong> [[${a}, ${b}], [${c}, ${d}]]<br>` +
                    `<strong>Déterminant:</strong> det = ${det} ≡ ${detMod} (mod ${mod})<br>` +
                    `<strong>Inverse du déterminant:</strong> ${detInv}<br>` +
                    `<strong>Matrice inverse:</strong> [[${invMatrix[0]}, ${invMatrix[1]}], [${invMatrix[2]}, ${invMatrix[3]}]]`;
                    
            } catch (error) {
                document.getElementById('hill-result').innerHTML = 
                    `<span style="color: #e76f51;">Erreur: ${error.message}</span>`;
            }
        }

        function dechiffrerHill() {
            try {
                const text = document.getElementById('hill-text').value.toUpperCase().replace(/[^A-Z]/g, '');
                const a = parseInt(document.getElementById('hill-a').value);
                const b = parseInt(document.getElementById('hill-b').value);
                const c = parseInt(document.getElementById('hill-c').value);
                const d = parseInt(document.getElementById('hill-d').value);
                const mod = 26;
                
                const invMatrix = inverseMatrix(a, b, c, d, mod);
                const invA = invMatrix[0], invB = invMatrix[1], invC = invMatrix[2], invD = invMatrix[3];
                
                let paddedText = text;
                if (paddedText.length % 2 !== 0) paddedText += 'X';
                
                let result = '';
                let steps = '<strong>Détail des calculs (déchiffrement) :</strong><br><br>';
                
                for (let i = 0; i < paddedText.length; i += 2) {
                    let c1 = paddedText.charCodeAt(i) - 64;
                    let c2 = paddedText.charCodeAt(i + 1) - 64;
                    
                    const c1_mod = c1 === 26 ? 0 : c1;
                    const c2_mod = c2 === 26 ? 0 : c2;
                    
                    let p1_calcul = (invA * c1_mod + invB * c2_mod) % mod;
                    let p2_calcul = (invC * c1_mod + invD * c2_mod) % mod;
                    
                    const p1 = p1_calcul === 0 ? 26 : p1_calcul;
                    const p2 = p2_calcul === 0 ? 26 : p2_calcul;
                    
                    const lettreOriginale1 = String.fromCharCode(p1 + 64);
                    const lettreOriginale2 = String.fromCharCode(p2 + 64);
                    
                    result += lettreOriginale1 + lettreOriginale2;
                    
                    steps += `<strong>Paire ${i/2 + 1}: "${paddedText[i]}${paddedText[i+1]}"</strong><br>`;
                    steps += `c1 = ${c1}, c2 = ${c2}<br>`;
                    if (c1 === 26) steps += `(c1 utilisé comme 0 dans calculs)<br>`;
                    if (c2 === 26) steps += `(c2 utilisé comme 0 dans calculs)<br>`;
                    steps += `<br>`;
                    
                    steps += `<strong>Calculs avec matrice inverse:</strong><br>`;
                    steps += `p1 = (${invA}×${c1_mod} + ${invB}×${c2_mod}) mod 26 = ${(invA * c1_mod + invB * c2_mod)} mod 26 = ${p1_calcul}`;
                    if (p1_calcul === 0) steps += ` (converti en 26 → Z)<br>`;
                    else steps += `<br>`;
                    steps += `Lettre = ${lettreOriginale1}<br><br>`;
                    
                    steps += `p2 = (${invC}×${c1_mod} + ${invD}×${c2_mod}) mod 26 = ${(invC * c1_mod + invD * c2_mod)} mod 26 = ${p2_calcul}`;
                    if (p2_calcul === 0) steps += ` (converti en 26 → Z)<br>`;
                    else steps += `<br>`;
                    steps += `Lettre = ${lettreOriginale2}<br><br>`;
                    
                    steps += `<strong>Résultat : "${lettreOriginale1}${lettreOriginale2}"</strong><br><br>`;
                    steps += '─'.repeat(50) + '<br><br>';
                }
                
                const det = determinant(a, b, c, d);
                const detMod = ((det % mod) + mod) % mod;
                const detInv = modInverse(detMod, mod);
                
                document.getElementById('hill-result').innerHTML = 
                    `<strong>Texte chiffré:</strong> ${text}<br>` +
                    `<strong>Texte avec padding:</strong> ${paddedText}<br><br>` +
                    `${steps}` +
                    `<strong>Texte déchiffré complet:</strong> <span style="color: #e9c46a; font-size: 1.2rem;">${result}</span>`;
                
                document.getElementById('hill-matrix-info').innerHTML = 
                    `<strong>Matrice inverse utilisée:</strong> [[${invA}, ${invB}], [${invC}, ${invD}]]<br>` +
                    `<strong>Déterminant original:</strong> ${det} ≡ ${detMod} (mod ${mod})<br>` +
                    `<strong>Vérification:</strong> (${det} × ${detInv}) mod ${mod} = ${(det * detInv) % mod}`;
                    
            } catch (error) {
                document.getElementById('hill-result').innerHTML = 
                    `<span style="color: #e76f51;">Erreur: ${error.message}</span>`;
            }
        }

        function effacerHill() {
            document.getElementById('hill-text').value = '';
            document.getElementById('hill-result').innerHTML = 
                '<span class="status-indicator"></span> Prêt à chiffrer...';
            document.getElementById('hill-matrix-info').innerHTML = 
                'Information sur la matrice apparaîtra ici...';
        }

        // ==================== CHIFFREMENT RSA ====================
        function pgcd(a, b) {
            while (b !== 0) [a, b] = [b, a % b];
            return a;
        }

        function modExp(base, exponent, modulus) {
            if (modulus === 1) return 0;
            let result = 1;
            base = base % modulus;
            while (exponent > 0) {
                if (exponent % 2 === 1) result = (result * base) % modulus;
                exponent = Math.floor(exponent / 2);
                base = (base * base) % modulus;
            }
            return result;
        }

        function findD(e, phi) {
            for (let d = 1; d < phi; d++) {
                if ((e * d) % phi === 1) return d;
            }
            return -1;
        }

        function chiffrerRSA() {
            try {
                const message = parseInt(document.getElementById('rsa-text').value);
                const p = parseInt(document.getElementById('rsa-p').value);
                const q = parseInt(document.getElementById('rsa-q').value);
                const e = parseInt(document.getElementById('rsa-e').value);
                
                if (isNaN(message) || isNaN(p) || isNaN(q) || isNaN(e)) {
                    throw new Error("Tous les champs doivent contenir des nombres valides !");
                }
                
                if (p === q) throw new Error("p et q doivent être différents !");
                
                const n = p * q;
                const phi = (p - 1) * (q - 1);
                
                if (e <= 1 || e >= phi || pgcd(e, phi) !== 1) {
                    throw new Error(`e (${e}) doit être premier avec φ(n)=${phi}`);
                }
                
                const d = findD(e, phi);
                if (d === -1) throw new Error("Impossible de trouver d");
                
                if (message >= n) throw new Error(`Le message (${message}) doit être < n (${n})`);
                
                const encrypted = modExp(message, e, n);
                
                document.getElementById('rsa-result').innerHTML = 
                    `<strong>Message original (M):</strong> ${message}<br><br>` +
                    `<strong>Calcul :</strong> C = Mᵉ mod n = ${message}<sup>${e}</sup> mod ${n}<br><br>` +
                    `<strong>Message chiffré (C):</strong> <span style="color: #2a9d8f;">${encrypted}</span>`;
                
                document.getElementById('rsa-keys').innerHTML = 
                    `<strong>Paramètres :</strong><br>` +
                    `p = ${p}, q = ${q}<br>` +
                    `n = p × q = ${n}<br>` +
                    `φ(n) = (p-1)(q-1) = ${phi}<br><br>` +
                    `<strong>Clé publique (n, e):</strong> (${n}, ${e})<br>` +
                    `<strong>Clé privée (n, d):</strong> (${n}, ${d})<br><br>` +
                    `<strong>Vérification :</strong><br>` +
                    `e × d mod φ(n) = ${(e * d) % phi}`;
                    
            } catch (error) {
                document.getElementById('rsa-result').innerHTML = 
                    `<span style="color: #e76f51;">Erreur: ${error.message}</span>`;
            }
        }

        function dechiffrerRSA() {
            try {
                const cipher = parseInt(document.getElementById('rsa-text').value);
                const p = parseInt(document.getElementById('rsa-p').value);
                const q = parseInt(document.getElementById('rsa-q').value);
                const e = parseInt(document.getElementById('rsa-e').value);
                
                if (isNaN(cipher) || isNaN(p) || isNaN(q) || isNaN(e)) {
                    throw new Error("Tous les champs doivent contenir des nombres valides !");
                }
                
                const n = p * q;
                const phi = (p - 1) * (q - 1);
                const d = findD(e, phi);
                
                if (d === -1) throw new Error("Impossible de trouver d");
                if (cipher >= n) throw new Error(`Le message chiffré (${cipher}) doit être < n (${n})`);
                
                const decrypted = modExp(cipher, d, n);
                
                document.getElementById('rsa-result').innerHTML = 
                    `<strong>Message chiffré (C):</strong> ${cipher}<br><br>` +
                    `<strong>Calcul :</strong> M = Cᵈ mod n = ${cipher}<sup>${d}</sup> mod ${n}<br><br>` +
                    `<strong>Message déchiffré (M):</strong> <span style="color: #e9c46a;">${decrypted}</span>`;
                
                document.getElementById('rsa-keys').innerHTML = 
                    `<strong>Clé privée utilisée (d):</strong> ${d}<br>` +
                    `<strong>Modulo (n):</strong> ${n}<br><br>` +
                    `<strong>Vérification :</strong> Mᵉ mod n = ${modExp(decrypted, e, n)}`;
                    
            } catch (error) {
                document.getElementById('rsa-result').innerHTML = 
                    `<span style="color: #e76f51;">Erreur: ${error.message}</span>`;
            }
        }

        function effacerRSA() {
            document.getElementById('rsa-text').value = '';
            document.getElementById('rsa-result').innerHTML = 
                '<span class="status-indicator"></span> Prêt à chiffrer...';
            document.getElementById('rsa-keys').innerHTML = 
                'Les clés RSA apparaîtront ici...';
        }

        // ==================== SCHÉMA DE FEISTEL MODIFIÉ (4 bits, sans clé) ====================
        // Fonctions F prédéfinies
        function f1(right) {
            switch(right) {
                case 0: return 1;  // 00 → 01
                case 1: return 2;  // 01 → 10
                case 2: return 3;  // 10 → 11
                case 3: return 0;  // 11 → 00
                default: return right;
            }
        }

        function f2(right) {
            switch(right) {
                case 0: return 2;  // 00 → 10
                case 1: return 3;  // 01 → 11
                case 2: return 0;  // 10 → 00
                case 3: return 1;  // 11 → 01
                default: return right;
            }
        }

        function binaryToNumber(binaryStr) {
            return parseInt(binaryStr, 2);
        }

        function numberToBinary2Bits(num) {
            return num.toString(2).padStart(2, '0');
        }

        function numberToBinary4Bits(num) {
            return num.toString(2).padStart(4, '0');
        }

        function chiffrerFeistel() {
            try {
                const binaryInput = document.getElementById('feistel-text').value.trim();
                
                // Vérifier que l'entrée est un nombre binaire de 4 bits
                if (!/^[01]{4}$/.test(binaryInput)) {
                    throw new Error("Veuillez entrer un nombre binaire de 4 bits (ex: 1010) !");
                }
                
                // Convertir l'entrée binaire en nombre
                const inputNumber = binaryToNumber(binaryInput);
                
                // Diviser en deux parties de 2 bits
                let g0 = (inputNumber >> 2) & 0x03;  // 2 bits de gauche
                let d0 = inputNumber & 0x03;         // 2 bits de droite
                
                let process = `<strong>Entrée binaire:</strong> ${binaryInput} (${inputNumber})<br>`;
                process += `<strong>Division initiale:</strong><br>`;
                process += `g₀ = ${numberToBinary2Bits(g0)} (${g0}) - 2 bits de gauche<br>`;
                process += `d₀ = ${numberToBinary2Bits(d0)} (${d0}) - 2 bits de droite<br><br>`;
                
                // Premier round
                process += `<strong>Round 1 (F₁) :</strong><br>`;
                const f1_result = f1(d0);
                process += `F₁(d₀) = F₁(${numberToBinary2Bits(d0)}) = ${numberToBinary2Bits(f1_result)} (${f1_result})<br>`;
                
                // Calcul de d₁ = g₀ ⊕ F₁(d₀)
                const d1 = g0 ^ f1_result;
                process += `d₁ = g₀ ⊕ F₁(d₀) = ${numberToBinary2Bits(g0)} ⊕ ${numberToBinary2Bits(f1_result)} = ${numberToBinary2Bits(d1)} (${d1})<br>`;
                
                // g₁ = d₀
                const g1 = d0;
                process += `g₁ = d₀ = ${numberToBinary2Bits(g1)} (${g1})<br><br>`;
                
                // Deuxième round
                process += `<strong>Round 2 (F₂) :</strong><br>`;
                const f2_result = f2(d1);
                process += `F₂(d₁) = F₂(${numberToBinary2Bits(d1)}) = ${numberToBinary2Bits(f2_result)} (${f2_result})<br>`;
                
                // Calcul de d₂ = g₁ ⊕ F₂(d₁)
                const d2 = g1 ^ f2_result;
                process += `d₂ = g₁ ⊕ F₂(d₁) = ${numberToBinary2Bits(g1)} ⊕ ${numberToBinary2Bits(f2_result)} = ${numberToBinary2Bits(d2)} (${d2})<br>`;
                
                // g₂ = d₁
                const g2 = d1;
                process += `g₂ = d₁ = ${numberToBinary2Bits(g2)} (${g2})<br><br>`;
                
                // Résultat final
                const resultBinary = (g2 << 2) | d2;
                const resultStr = numberToBinary4Bits(resultBinary);
                
                process += `<strong>Résultat final :</strong><br>`;
                process += `Texte chiffré = g₂ || d₂ = ${numberToBinary2Bits(g2)}${numberToBinary2Bits(d2)} = ${resultStr} (${resultBinary})<br><br>`;
                
                // Tableau récapitulatif
                process += `<strong>Tableau récapitulatif :</strong><br>`;
                process += `<table style="border-collapse: collapse; width: 100%; margin: 15px 0;">`;
                process += `<tr style="background: rgba(76, 201, 240, 0.2);">`;
                process += `<th style="border: 1px solid #4cc9f0; padding: 8px;">Étape</th>`;
                process += `<th style="border: 1px solid #4cc9f0; padding: 8px;">g (gauche)</th>`;
                process += `<th style="border: 1px solid #4cc9f0; padding: 8px;">d (droite)</th>`;
                process += `<th style="border: 1px solid #4cc9f0; padding: 8px;">F(d)</th>`;
                process += `</tr>`;
                
                process += `<tr>`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">Initial</td>`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">${numberToBinary2Bits(g0)}</td>`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">${numberToBinary2Bits(d0)}</td>`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">-</td>`;
                process += `</tr>`;
                
                process += `<tr style="background: rgba(42, 157, 143, 0.1);">`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">Round 1</td>`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">${numberToBinary2Bits(g1)}</td>`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">${numberToBinary2Bits(d1)}</td>`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">F₁(${numberToBinary2Bits(d0)}) = ${numberToBinary2Bits(f1_result)}</td>`;
                process += `</tr>`;
                
                process += `<tr style="background: rgba(233, 196, 106, 0.1);">`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">Round 2</td>`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">${numberToBinary2Bits(g2)}</td>`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">${numberToBinary2Bits(d2)}</td>`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">F₂(${numberToBinary2Bits(d1)}) = ${numberToBinary2Bits(f2_result)}</td>`;
                process += `</tr>`;
                
                process += `<tr style="background: rgba(76, 201, 240, 0.2); font-weight: bold;">`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">Final</td>`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">${numberToBinary2Bits(g2)}</td>`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">${numberToBinary2Bits(d2)}</td>`;
                process += `<td style="border: 1px solid #4cc9f0; padding: 8px;">${resultStr}</td>`;
                process += `</tr>`;
                
                process += `</table>`;
                
                document.getElementById('feistel-result').innerHTML = 
                    process + 
                    `<strong>Résultat chiffré :</strong> <span style="color: #2a9d8f; font-size: 1.2rem;">${resultStr}</span> (${resultBinary})`;
                    
            } catch (error) {
                document.getElementById('feistel-result').innerHTML = 
                    `<span style="color: #e76f51;">Erreur: ${error.message}</span>`;
            }
        }

        function dechiffrerFeistel() {
            try {
                const binaryInput = document.getElementById('feistel-text').value.trim();
                
                if (!/^[01]{4}$/.test(binaryInput)) {
                    throw new Error("Veuillez entrer un nombre binaire de 4 bits (ex: 1010) !");
                }
                
                const inputNumber = binaryToNumber(binaryInput);
                let g2 = (inputNumber >> 2) & 0x03;
                let d2 = inputNumber & 0x03;
                
                let process = `<strong>Texte chiffré:</strong> ${binaryInput} (${inputNumber})<br>`;
                process += `<strong>Division initiale:</strong><br>`;
                process += `g₂ = ${numberToBinary2Bits(g2)} (${g2})<br>`;
                process += `d₂ = ${numberToBinary2Bits(d2)} (${d2})<br><br>`;
                
                process += `<strong>Déchiffrement :</strong><br><br>`;
                
                // Round 2 inverse
                process += `<strong>Round 2 inverse :</strong><br>`;
                const d1 = g2;
                process += `d₁ = g₂ = ${numberToBinary2Bits(d1)} (${d1})<br>`;
                
                const f2_result = f2(d1);
                process += `F₂(d₁) = F₂(${numberToBinary2Bits(d1)}) = ${numberToBinary2Bits(f2_result)} (${f2_result})<br>`;
                
                const g1 = d2 ^ f2_result;
                process += `g₁ = d₂ ⊕ F₂(d₁) = ${numberToBinary2Bits(d2)} ⊕ ${numberToBinary2Bits(f2_result)} = ${numberToBinary2Bits(g1)} (${g1})<br><br>`;
                
                // Round 1 inverse
                process += `<strong>Round 1 inverse :</strong><br>`;
                const d0 = g1;
                process += `d₀ = g₁ = ${numberToBinary2Bits(d0)} (${d0})<br>`;
                
                const f1_result = f1(d0);
                process += `F₁(d₀) = F₁(${numberToBinary2Bits(d0)}) = ${numberToBinary2Bits(f1_result)} (${f1_result})<br>`;
                
                const g0 = d1 ^ f1_result;
                process += `g₀ = d₁ ⊕ F₁(d₀) = ${numberToBinary2Bits(d1)} ⊕ ${numberToBinary2Bits(f1_result)} = ${numberToBinary2Bits(g0)} (${g0})<br><br>`;
                
                // Reconstruction
                const originalBinary = (g0 << 2) | d0;
                const originalStr = numberToBinary4Bits(originalBinary);
                
                process += `<strong>Résultat final :</strong><br>`;
                process += `Texte déchiffré = g₀ || d₀ = ${numberToBinary2Bits(g0)}${numberToBinary2Bits(d0)} = ${originalStr} (${originalBinary})<br><br>`;
                
                document.getElementById('feistel-result').innerHTML = 
                    process + 
                    `<strong>Texte déchiffré :</strong> <span style="color: #e9c46a; font-size: 1.2rem;">${originalStr}</span> (${originalBinary})`;
                    
            } catch (error) {
                document.getElementById('feistel-result').innerHTML = 
                    `<span style="color: #e76f51;">Erreur: ${error.message}</span>`;
            }
        }

        function effacerFeistel() {
            document.getElementById('feistel-text').value = '1010';
            document.getElementById('feistel-result').innerHTML = 
                '<span class="status-indicator"></span> Prêt à chiffrer...';
        }

        // ==================== INITIALISATION ====================
        window.onload = function() {
            showRandomSecurityTip();
            chiffrerCesar();
            chiffrerVigenere();
            chiffrerHill();
            chiffrerRSA();
            chiffrerFeistel();
        };
    </script>
</body>
</html>
